<app-header></app-header>

<mat-toolbar>
  <mat-toolbar-row fxLayout="row" fxLayoutAlign="center stretch" 
                   fxShow="true" fxHide.lt-md="true">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
        Home
      </a>
      <a routerLink="/projects/" routerLinkActive="active">
        Projects
      </a>
      
      <ng-container *ngIf="authGuard.validating$ | async; else adminLink">
        <img class="loading" src="\assets\images\revolver.png" /> 
      </ng-container>
      <ng-template #adminLink>
        <ng-container *ngIf="authGuard.isLoggedIn$ | async; else login">
          <a routerLink="/admin/" routerLinkActive="active">Admin</a>
        </ng-container>
        <ng-template #login>
          <a routerLink="/login/" routerLinkActive="active">Login</a>
        </ng-template>
      </ng-template>

  </mat-toolbar-row>

  <mat-toolbar-row fxShow="true" fxHide.gt-sm="true" class="mobile" fxLayout="row" fxLayoutAlign="center stretch" >
        <a (click)="drawer.toggle()"> Menu </a>
  </mat-toolbar-row>
</mat-toolbar>

<mat-drawer-container autosize>
  <mat-drawer #drawer mode="over" fxHide.gt-sm="true" >
    <div fxLayout="column" fxLayoutAlign="none">
      <a routerLink="/"> Home </a>
      <a routerLink="/projects/"> Projects </a>

      <ng-container *ngIf="authGuard.isLoggedIn$ | async; else sideLogin">
        <a routerLink="/admin/" routerLinkActive="active">Admin</a>
      </ng-container>
      <ng-template #sideLogin>
        <a routerLink="/login/" routerLinkActive="active">Login</a>
      </ng-template>

    </div>
  </mat-drawer>
  
  <div class="container" fxLayout="column">
    <div class="admin-menu" fxFlex="60"
        fxLayout="row" fxLayoutAlign="center center"
        *ngIf="router.isActive('/admin', false) && (authGuard.isLoggedIn$ | async)">
     <a *ngIf="authGuard.canSee('/admin')"
     [routerLink]="['/admin']" [routerLinkActiveOptions]="{ exact: true }" routerLinkActive="active">admin</a>

      <a *ngIf="authGuard.canSee('/admin/editor/projects')"
       [routerLink]="['/admin/editor/projects']" routerLinkActive="active">projects</a>
      
      <a *ngIf="authGuard.canSee('/admin/editor/categories/')" 
      [routerLink]="['/admin/editor/categories']" routerLinkActive="active">categories</a>
      
      <a *ngIf="authGuard.canSee('/admin/editor/introduction')"
      [routerLink]="['/admin/editor/introduction']" routerLinkActive="active">introduction</a>
      
      <a *ngIf="authGuard.canSee('/admin/editor/accounts')"
      [routerLink]="['/admin/editor/accounts']" routerLinkActive="active">accounts</a>
    </div>

    <div class="content" fxFlex>
      <router-outlet></router-outlet>
    </div>
  </div>
</mat-drawer-container>

<app-footer></app-footer>
